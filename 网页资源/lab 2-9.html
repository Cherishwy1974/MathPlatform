<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>等价无穷小倒水游戏</title>
    <!-- Tailwind CSS 本地化 -->
    <script src="../common-assets/js/tailwind.min.js"></script>
    <!-- Google Material Symbols 本地化 -->
    <link rel="stylesheet" href="../common-assets/css/lab1-material-symbols.css">
    <!-- MathJax 本地化配置 -->
    <script src="../common-assets/js/mathjax-config.js"></script>
    <script defer src="../common-assets/js/mathjax-3.2.2-tex-svg.min.js"></script>
    <!-- 页面样式 -->
    <link rel="stylesheet" href="assets/lab2-9.css">
</head>
<body class="flex flex-col h-screen overflow-hidden text-slate-800">

<!-- 返回主页面板 -->
<div class="return-links">
    <a href="index.html"><span class="material-symbols-outlined">home</span> 返回主页</a>
</div>

<!-- Top Navigation / Header -->
<header class="glass z-20 px-4 py-3 flex justify-between items-center shrink-0">
    <div class="flex items-center gap-3">
        <div class="p-2 bg-indigo-600 rounded-lg text-white shadow-lg shadow-indigo-200 cursor-pointer" onclick="toggleReturnLinks()">
            <span class="material-symbols-outlined text-xl">science</span>
        </div>
        <div>
            <h1 class="text-lg font-bold leading-tight">等价无穷小挑战</h1>
            <p class="text-xs text-slate-500">将同阶无穷小归类</p>
        </div>
    </div>
    <!-- Stats Board -->
    <div class="flex gap-4 text-sm font-medium">
        <div class="flex flex-col items-end">
            <span class="text-xs text-slate-400 uppercase tracking-wider">关卡</span>
            <span class="text-indigo-600 font-bold text-lg" id="level-display">1</span>
        </div>
        <div class="flex flex-col items-end">
            <span class="text-xs text-slate-400 uppercase tracking-wider">步数</span>
            <span class="text-slate-700 font-bold text-lg" id="moves-display">0</span>
        </div>
    </div>
</header>

<!-- Main Game Area -->
<main class="flex-1 relative overflow-hidden flex flex-col">
    <!-- Game Container (Bottles) -->
    <div class="flex-1 overflow-y-auto no-scrollbar p-4 md:p-8 flex items-center justify-center" id="game-area">
        <div class="grid gap-x-4 gap-y-8 w-full max-w-2xl mx-auto transition-all duration-300 grid-cols-4" id="bottles-grid">
            <!-- 瓶子将由JavaScript动态生成 -->
        </div>
    </div>

    <!-- Formula Reference Panel (Overlay) -->
    <div class="absolute inset-0 bg-white/95 backdrop-blur-md z-30 transform translate-y-full transition-transform duration-300 flex flex-col" id="reference-panel">
        <div class="p-4 border-b flex justify-between items-center bg-slate-50">
            <h2 class="font-bold text-lg flex items-center gap-2">
                <span class="material-symbols-outlined text-indigo-600">menu_book</span>
                公式速查表 ($x \to 0$)
            </h2>
            <button class="p-2 hover:bg-slate-200 rounded-full transition-colors" onclick="toggleReference()">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <div class="flex-1 overflow-y-auto p-4 space-y-4" id="formula-list">
            <!-- 公式列表将由JavaScript动态生成 -->
        </div>
    </div>

    <!-- Game Complete Overlay -->
    <div class="absolute inset-0 bg-black/50 z-40 hidden flex items-center justify-center backdrop-blur-sm" id="complete-modal">
        <div class="bg-white rounded-2xl p-8 max-w-sm w-full mx-4 text-center shadow-2xl transform scale-95 opacity-0 transition-all duration-300" id="modal-content">
            <div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="material-symbols-outlined text-3xl">emoji_events</span>
            </div>
            <h2 class="text-2xl font-bold mb-2 text-slate-800">恭喜过关!</h2>
            <p class="text-slate-500 mb-6">下一关难度将提升，准备好了吗？</p>
            <button class="w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all active:scale-95" onclick="game.nextLevel()">
                挑战下一关
            </button>
        </div>
    </div>
</main>

<!-- Bottom Controls -->
<footer class="glass px-4 py-3 shrink-0 flex justify-between items-center z-20 md:justify-center md:gap-8">
    <button class="flex flex-col items-center gap-1 text-slate-500 hover:text-indigo-600 transition-colors" onclick="game.undo()">
        <span class="material-symbols-outlined">undo</span>
        <span class="text-[10px]">撤销</span>
    </button>
    <button class="flex flex-col items-center gap-1 text-slate-500 hover:text-indigo-600 transition-colors" onclick="game.resetLevel()">
        <span class="material-symbols-outlined">restart_alt</span>
        <span class="text-[10px]">重置</span>
    </button>
    <!-- Mode Toggle -->
    <div class="flex items-center bg-slate-200 rounded-full p-1 relative">
        <button class="w-20 py-1.5 rounded-full text-xs font-bold z-10 transition-colors text-slate-600" id="mode-btn-math" onclick="game.setMode('math')">
            公式
        </button>
        <button class="w-20 py-1.5 rounded-full text-xs font-bold z-10 transition-colors text-slate-500" id="mode-btn-color" onclick="game.setMode('color')">
            颜色
        </button>
        <div class="absolute top-1 left-1 w-20 h-[calc(100%-8px)] bg-white rounded-full shadow-sm transition-transform duration-300" id="mode-indicator"></div>
    </div>
    <button class="flex flex-col items-center gap-1 text-slate-500 hover:text-indigo-600 transition-colors" onclick="toggleReference()">
        <span class="material-symbols-outlined">help</span>
        <span class="text-[10px]">公式</span>
    </button>
</footer>

<!-- Toast Notification -->
<div class="fixed top-20 left-1/2 -translate-x-1/2 px-4 py-2 bg-slate-800/90 text-white text-sm rounded-full shadow-xl z-50 pointer-events-none opacity-0 transition-opacity duration-300" id="toast">
    提示信息
</div>

<!-- 页面脚本 -->
<script src="assets/lab2-9.js"></script>

</body>
</html>
