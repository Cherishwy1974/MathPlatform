<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜ç­‰æ•°å­¦Â·è°æ˜¯å§åº• (Calculus Edition)</title>
    
    <!-- æœ¬åœ°åŒ–å­—ä½“èµ„æº -->
    <link rel="stylesheet" href="../../common-assets/css/lab1-google-fonts.css">
    <link rel="stylesheet" href="../../common-assets/css/lab1-material-symbols.css">
    
    <style>
        /* ============================================
           1. CSS VARIABLES & RESET
        ============================================ */
        :root {
            --bg-primary: #1a1d24;
            --bg-secondary: #242830;
            --bg-card: #2d323c;
            --bg-elevated: #363c4a;
            
            --text-primary: #e8eaed;
            --text-secondary: #9aa0a6;
            --text-muted: #5f6368;
            
            --accent-green: #34a853;
            --accent-green-dark: #1e7e34;
            --accent-red: #ea4335;
            --accent-red-dark: #b31412;
            --accent-amber: #fbbc04;
            --accent-blue: #4285f4;
            --accent-purple: #a855f7;
            
            --border-color: rgba(255,255,255,0.1);
            --shadow: 0 8px 32px rgba(0,0,0,0.3);
            
            --font-display: 'Ma Shan Zheng', cursive;
            --font-body: 'Noto Serif SC', serif;
            --font-fun: 'ZCOOL QingKe HuangYou', cursive;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-body);
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        /* ============================================
           2. LAYOUT & CONTAINER
        ============================================ */
        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 1rem;
            padding-bottom: 100px;
        }
        
        .hidden { display: none !important; }
        
        /* ============================================
           3. HEADER
        ============================================ */
        .header {
            text-align: center;
            padding: 1.5rem 0;
            margin-bottom: 1rem;
        }
        
        .header h1 {
            font-family: var(--font-display);
            font-size: 2.8rem;
            color: var(--text-primary);
            text-shadow: 0 4px 20px rgba(52, 168, 83, 0.3);
            letter-spacing: 0.15em;
            margin-bottom: 0.5rem;
        }
        
        .header .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, var(--accent-green-dark), var(--accent-green));
            padding: 0.4rem 1rem;
            border-radius: 2rem;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
        }
        
        /* ============================================
           4. CARD BASE STYLES
        ============================================ */
        .card {
            background: var(--bg-card);
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 1rem;
        }
        
        .card-header {
            background: var(--bg-elevated);
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-header h2 {
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-amber);
        }
        
        .card-body { padding: 1.25rem; }
        
        /* ============================================
           5. BUTTONS
        ============================================ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-family: var(--font-body);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
        }
        
        .btn:active { transform: scale(0.97); }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dark));
            color: white;
            width: 100%;
            padding: 1rem;
            font-size: 1.15rem;
        }
        
        .btn-primary:hover { filter: brightness(1.1); }
        
        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }
        
        .btn-danger {
            background: var(--accent-red-dark);
            color: white;
            border: 1px solid var(--accent-red);
        }
        
        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
            border-radius: 0.5rem;
        }
        
        /* ============================================
           6. FORM ELEMENTS
        ============================================ */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
            font-weight: 600;
        }
        
        .form-label .value {
            font-family: var(--font-fun);
            font-size: 1.5rem;
            color: var(--accent-green);
        }
        
        .form-label .value.red { color: var(--accent-red); }
        
        /* Range Slider */
        input[type="range"] {
            width: 100%;
            height: 8px;
            background: var(--bg-elevated);
            border-radius: 4px;
            appearance: none;
            cursor: pointer;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--accent-green);
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        /* Button Group */
        .btn-group {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-group .btn {
            flex: 1;
            padding: 0.6rem;
            background: var(--bg-elevated);
            color: var(--text-secondary);
            border: 2px solid transparent;
        }
        
        .btn-group .btn.active {
            background: var(--accent-red-dark);
            color: white;
            border-color: var(--accent-red);
        }
        
        /* Pack Grid */
        .pack-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }
        
        .pack-btn {
            padding: 1rem 0.5rem;
            background: var(--bg-elevated);
            border: 2px solid transparent;
            border-radius: 0.75rem;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            transition: all 0.2s;
        }
        
        .pack-btn .material-symbols-outlined {
            font-size: 1.8rem;
        }
        
        .pack-btn:hover { background: rgba(255,255,255,0.08); }
        
        .pack-btn.active {
            border-color: var(--accent-blue);
            background: rgba(66, 133, 244, 0.15);
            color: var(--text-primary);
        }
        
        /* ============================================
           7. COLLAPSIBLE SECTION
        ============================================ */
        .collapsible {
            cursor: pointer;
        }
        
        .collapsible .icon {
            transition: transform 0.3s;
        }
        
        .collapsible.open .icon {
            transform: rotate(180deg);
        }
        
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .collapsible-content.open {
            max-height: 500px;
        }
        
        /* ============================================
           8. PASS VIEW
        ============================================ */
        .pass-view {
            text-align: center;
            padding: 3rem 2rem;
        }
        
        .pass-view .icon {
            font-size: 4rem;
            color: var(--accent-amber);
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(-10%); }
            50% { transform: translateY(0); }
        }
        
        .pass-view .player-num {
            font-family: var(--font-display);
            font-size: 4rem;
            color: var(--accent-green);
            margin: 1rem 0 2rem;
        }
        
        /* ============================================
           9. FLIP CARD
        ============================================ */
        .flip-card {
            width: 220px;
            height: 280px;
            perspective: 1000px;
            cursor: pointer;
            margin: 0 auto 1.5rem;
        }
        
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }
        
        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            text-align: center;
        }
        
        .flip-card-front {
            background: linear-gradient(145deg, #3b4252, #2e3440);
            border: 2px solid rgba(129, 140, 248, 0.3);
        }
        
        .flip-card-front .material-symbols-outlined {
            font-size: 3.5rem;
            color: var(--accent-blue);
            margin-bottom: 1rem;
        }
        
        .flip-card-back {
            transform: rotateY(180deg);
            background: linear-gradient(145deg, #2d4a3e, #1e3932);
            border: 2px solid var(--accent-green);
        }
        
        .flip-card-back .word {
            font-family: var(--font-display);
            font-size: 2.5rem;
            color: white;
            word-break: break-all;
        }
        
        .flip-card-back .label {
            font-size: 0.75rem;
            color: var(--accent-green);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(52, 168, 83, 0.3);
        }
        
        /* ============================================
           10. PLAYER LIST
        ============================================ */
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .player-item:last-child { border-bottom: none; }
        
        .player-item.dead {
            opacity: 0.4;
            background: rgba(0,0,0,0.2);
        }
        
        .player-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .player-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--accent-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .player-item.dead .player-avatar {
            background: var(--text-muted);
        }
        
        .player-role {
            font-size: 0.8rem;
            padding: 0.2rem 0.5rem;
            border-radius: 0.25rem;
            margin-left: 0.5rem;
        }
        
        .player-role.spy {
            background: rgba(234, 67, 53, 0.2);
            color: var(--accent-red);
        }
        
        .player-role.civ {
            background: rgba(52, 168, 83, 0.2);
            color: var(--accent-green);
        }
        
        /* ============================================
           11. GOD VIEW (ä¸Šå¸è§†è§’)
        ============================================ */
        .god-view {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 2px solid var(--accent-purple);
            border-radius: 1rem;
            margin-bottom: 1rem;
            overflow: hidden;
        }
        
        .god-view-header {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(139, 92, 246, 0.1));
            padding: 1rem 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            border-bottom: 1px solid rgba(168, 85, 247, 0.3);
        }
        
        .god-view-header h3 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-purple);
            font-size: 1rem;
        }
        
        .god-view-body {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .god-view-body.open {
            padding: 1.25rem;
            max-height: 1000px;
        }
        
        .word-pair {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.25rem;
        }
        
        .word-box {
            background: rgba(255,255,255,0.05);
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
        }
        
        .word-box.civ { border: 1px solid rgba(52, 168, 83, 0.4); }
        .word-box.spy { border: 1px solid rgba(234, 67, 53, 0.4); }
        
        .word-box .label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }
        
        .word-box.civ .label { color: var(--accent-green); }
        .word-box.spy .label { color: var(--accent-red); }
        
        .word-box .word {
            font-family: var(--font-display);
            font-size: 1.8rem;
            color: white;
        }
        
        .word-box .def {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }
        
        /* æ•™å­¦è¦ç‚¹ */
        .teaching-section {
            background: rgba(255,255,255,0.03);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .teaching-section h4 {
            color: var(--accent-amber);
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .teaching-section p {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }
        
        .teaching-section .highlight {
            color: var(--accent-amber);
            font-weight: 600;
        }
        
        .teaching-section .formula {
            display: inline-block;
            background: rgba(66, 133, 244, 0.15);
            padding: 0.15rem 0.5rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', monospace;
            color: var(--accent-blue);
            font-size: 0.8rem;
        }
        
        .tips-list {
            list-style: none;
            padding: 0;
        }
        
        .tips-list li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .tips-list li::before {
            content: "ğŸ’¡";
            position: absolute;
            left: 0;
            font-size: 0.9rem;
        }
        
        /* ============================================
           12. END VIEW
        ============================================ */
        .result-banner {
            text-align: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(52, 168, 83, 0.2), rgba(52, 168, 83, 0.05));
            border: 1px solid rgba(52, 168, 83, 0.4);
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
        }
        
        .result-banner h2 {
            font-family: var(--font-display);
            font-size: 2rem;
            color: white;
        }
        
        .final-words {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .final-word-box {
            background: var(--bg-elevated);
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
        }
        
        .final-word-box .label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
        }
        
        .final-word-box .word {
            font-family: var(--font-display);
            font-size: 1.5rem;
            margin: 0.5rem 0;
        }
        
        .final-word-box.civ .word { color: var(--accent-green); }
        .final-word-box.spy .word { color: var(--accent-red); }
        
        .final-word-box .def {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        .end-player-list {
            background: var(--bg-elevated);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .end-player-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.9rem;
        }
        
        .end-player-list li:last-child { border-bottom: none; }
        
        /* ============================================
           13. FIXED BOTTOM BAR
        ============================================ */
        .bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 1rem;
            z-index: 100;
        }
        
        .bottom-bar .btn {
            width: 100%;
        }
        
        /* ============================================
           14. UTILITIES
        ============================================ */
        .text-center { text-align: center; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mt-2 { margin-top: 1rem; }
        .text-muted { color: var(--text-muted); }
        .text-sm { font-size: 0.85rem; }
    </style>
</head>

<body>
    <div class="container">
        <!-- ==================== HEADER ==================== -->
        <header class="header">
            <h1>è°æ˜¯å§åº•</h1>
            <div class="badge">
                <span class="material-symbols-outlined">school</span>
                é«˜ç­‰æ•°å­¦ç‰¹åˆ«ç‰ˆ
            </div>
        </header>

        <!-- ==================== RULES SECTION ==================== -->
        <div class="card">
            <div class="card-header collapsible" onclick="toggleRules()">
                <h2>
                    <span class="material-symbols-outlined">help_outline</span>
                    ç©æ³•è¯´æ˜
                </h2>
                <span class="material-symbols-outlined icon">expand_more</span>
            </div>
            <div class="collapsible-content" id="rules-content">
                <div class="card-body">
                    <p class="text-sm" style="color: var(--text-secondary); line-height: 1.8;">
                        <strong style="color: var(--text-primary);">æ¸¸æˆæµç¨‹ï¼š</strong><br>
                        1ï¸âƒ£ æ¯äººæ‹¿åˆ°ä¸€ä¸ªé«˜æ•°åè¯ï¼Œå§åº•çš„è¯ä¸å¤§å®¶ä¸åŒä½†ç›¸ä¼¼<br>
                        2ï¸âƒ£ è½®æµç”¨ä¸€å¥è¯æè¿°è‡ªå·±çš„è¯ï¼ˆä¸èƒ½ç›´æ¥è¯´å‡ºè¯è¯­ï¼‰<br>
                        3ï¸âƒ£ æè¿°å®ŒåæŠ•ç¥¨æ·˜æ±°ä¸€äºº<br>
                        4ï¸âƒ£ å¹³æ°‘æ‰¾å‡ºæ‰€æœ‰å§åº•åˆ™èƒœï¼Œå§åº•å­˜æ´»è‡³æœ€ååˆ™èƒœ
                    </p>
                </div>
            </div>
        </div>

        <!-- ==================== 1. SETUP VIEW ==================== -->
        <div id="view-setup">
            <div class="card">
                <div class="card-body">
                    <!-- ç©å®¶äººæ•° -->
                    <div class="form-group">
                        <div class="form-label">
                            <span>ç©å®¶äººæ•°</span>
                            <span class="value" id="player-count-display">6</span>
                        </div>
                        <input type="range" id="player-slider" min="4" max="12" value="6">
                    </div>

                    <!-- å§åº•äººæ•° -->
                    <div class="form-group">
                        <div class="form-label">
                            <span>å§åº•äººæ•°</span>
                            <span class="value red" id="spy-count-display">1</span>
                        </div>
                        <div class="btn-group">
                            <button class="btn active" data-spy="1" onclick="setSpyCount(1)">1</button>
                            <button class="btn" data-spy="2" onclick="setSpyCount(2)">2</button>
                            <button class="btn" data-spy="3" onclick="setSpyCount(3)">3</button>
                        </div>
                    </div>

                    <!-- è¯åº“é€‰æ‹© -->
                    <div class="form-group">
                        <div class="form-label">
                            <span>é€‰æ‹©è¯åº“</span>
                        </div>
                        <div class="pack-grid">
                            <button class="pack-btn active" data-pack="limits" onclick="selectPack('limits')">
                                <span class="material-symbols-outlined">all_inclusive</span>
                                æé™ä¸è¿ç»­
                            </button>
                            <button class="pack-btn" data-pack="derivatives" onclick="selectPack('derivatives')">
                                <span class="material-symbols-outlined">show_chart</span>
                                å¯¼æ•°ä¸å¾®åˆ†
                            </button>
                            <button class="pack-btn" data-pack="applications" onclick="selectPack('applications')">
                                <span class="material-symbols-outlined">function</span>
                                å¯¼æ•°åº”ç”¨
                            </button>
                            <button class="pack-btn" data-pack="integrals" onclick="selectPack('integrals')">
                                <span class="material-symbols-outlined">area_chart</span>
                                ç§¯åˆ†ä¸“é¢˜
                            </button>
                            <button class="pack-btn" data-pack="mixed" onclick="selectPack('mixed')">
                                <span class="material-symbols-outlined">shuffle</span>
                                å…¨é¢˜å‹æ··åˆ
                            </button>
                            <button class="pack-btn" data-pack="classic" onclick="selectPack('classic')">
                                <span class="material-symbols-outlined">celebration</span>
                                ç»å…¸é¢˜ç›®
                            </button>
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="startGame()">
                        <span class="material-symbols-outlined">play_circle</span>
                        å¼€å§‹å‘ç‰Œ
                    </button>
                </div>
            </div>
        </div>

        <!-- ==================== 2. PASS VIEW ==================== -->
        <div id="view-pass" class="hidden">
            <div class="card">
                <div class="pass-view">
                    <span class="material-symbols-outlined icon">smartphone</span>
                    <h2 class="mb-1">è¯·ä¼ é€’ç»™</h2>
                    <div class="player-num" id="pass-player-num">1å·</div>
                    <button class="btn btn-secondary" onclick="enterReveal()" style="width: 100%;">
                        æˆ‘æ˜¯ <span id="btn-pass-num">1å·</span>ï¼Œç‚¹å‡»çœ‹è¯
                    </button>
                </div>
            </div>
        </div>

        <!-- ==================== 3. REVEAL VIEW ==================== -->
        <div id="view-reveal" class="hidden">
            <div class="card">
                <div class="card-header">
                    <span id="reveal-player-id" style="color: var(--text-secondary); font-family: monospace;">PLAYER 1</span>
                    <span style="color: var(--accent-amber); font-size: 0.8rem;">ğŸ”’ æ³¨æ„ä¿å¯†</span>
                </div>
                <div class="card-body text-center">
                    <div class="flip-card" id="card-element" onclick="flipCard()">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <span class="material-symbols-outlined">touch_app</span>
                                <h3>ç‚¹å‡»ç¿»ç‰Œ</h3>
                                <p class="text-sm text-muted mt-2">æŸ¥çœ‹ä½ çš„å…³é”®è¯</p>
                            </div>
                            <div class="flip-card-back">
                                <div class="label">ä½ çš„è¯è¯­</div>
                                <div class="word" id="word-display">åŠ è½½ä¸­...</div>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary hidden" id="btn-next-player" onclick="nextPlayer()">
                        è®°ä½äº†ï¼Œä¼ ç»™ä¸‹ä¸€ä½
                    </button>
                </div>
            </div>
        </div>

        <!-- ==================== 4. GAME VIEW ==================== -->
        <div id="view-game" class="hidden">
            <!-- ä¸Šå¸è§†è§’é¢æ¿ -->
            <div class="god-view" id="god-view">
                <div class="god-view-header" onclick="toggleGodView()">
                    <h3>
                        <span class="material-symbols-outlined">visibility</span>
                        ä¸Šå¸è§†è§’ Â· æ•™å­¦è¦ç‚¹
                    </h3>
                    <span class="material-symbols-outlined icon" id="god-view-icon">expand_more</span>
                </div>
                <div class="god-view-body" id="god-view-body">
                    <!-- è¯è¯­å¯¹æ¯” -->
                    <div class="word-pair">
                        <div class="word-box civ">
                            <div class="label">å¹³æ°‘è¯</div>
                            <div class="word" id="god-word-civ">--</div>
                            <div class="def" id="god-def-civ">--</div>
                        </div>
                        <div class="word-box spy">
                            <div class="label">å§åº•è¯</div>
                            <div class="word" id="god-word-spy">--</div>
                            <div class="def" id="god-def-spy">--</div>
                        </div>
                    </div>
                    
                    <!-- æ ¸å¿ƒåŒºåˆ« -->
                    <div class="teaching-section">
                        <h4>
                            <span class="material-symbols-outlined">compare</span>
                            æ ¸å¿ƒåŒºåˆ«
                        </h4>
                        <p id="god-difference">--</p>
                    </div>
                    
                    <!-- å½¢è±¡æ¯”å–» -->
                    <div class="teaching-section">
                        <h4>
                            <span class="material-symbols-outlined">lightbulb</span>
                            å½¢è±¡æ¯”å–»
                        </h4>
                        <p id="god-analogy">--</p>
                    </div>
                    
                    <!-- æè¿°æç¤º -->
                    <div class="teaching-section">
                        <h4>
                            <span class="material-symbols-outlined">emoji_objects</span>
                            æè¿°æ€è·¯æç¤º
                        </h4>
                        <ul class="tips-list" id="god-tips">
                            <li>--</li>
                        </ul>
                    </div>
                    
                    <!-- è€ƒç‚¹æé†’ -->
                    <div class="teaching-section">
                        <h4>
                            <span class="material-symbols-outlined">school</span>
                            è€ƒç‚¹æé†’
                        </h4>
                        <p id="god-exam">--</p>
                    </div>
                </div>
            </div>

            <!-- ç©å®¶åˆ—è¡¨ -->
            <div class="card">
                <div class="card-header">
                    <h2>
                        <span class="material-symbols-outlined">group</span>
                        å­˜æ´»ç©å®¶
                    </h2>
                    <span class="text-sm text-muted" id="alive-count">6/6</span>
                </div>
                <div id="player-list">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- åº•éƒ¨æ“ä½œæ  -->
            <div class="bottom-bar">
                <button class="btn btn-danger" onclick="endGame()">
                    ç»“æŸæ¸¸æˆ & æ­æ™“è°œåº•
                </button>
            </div>
        </div>

        <!-- ==================== 5. END VIEW ==================== -->
        <div id="view-end" class="hidden">
            <div class="card">
                <div class="card-body">
                    <div class="result-banner" id="result-banner">
                        <h2 id="winner-text">æ¸¸æˆç»“æŸ</h2>
                    </div>

                    <div class="final-words">
                        <div class="final-word-box civ">
                            <div class="label">å¹³æ°‘è¯</div>
                            <div class="word" id="end-word-civ">--</div>
                            <div class="def" id="end-def-civ">--</div>
                        </div>
                        <div class="final-word-box spy">
                            <div class="label">å§åº•è¯</div>
                            <div class="word" id="end-word-spy">--</div>
                            <div class="def" id="end-def-spy">--</div>
                        </div>
                    </div>

                    <div class="end-player-list">
                        <ul id="end-player-list">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </ul>
                    </div>

                    <button class="btn btn-primary" onclick="resetGame()">
                        å†æ¥ä¸€å±€
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== JAVASCRIPT ==================== -->
    <script>
    // ============================================
    // 1. WORD PACKS DATA (å«è¯¦ç»†æ•™å­¦æè¿°)
    // ============================================
    const wordPacks = {
        limits: [
            {
                civ: "æ— ç©·å°", spy: "é›¶",
                civ_def: "æé™ä¸º0çš„å˜é‡",
                spy_def: "ç»å¯¹çš„æ— ï¼Œä¸€ä¸ªç¡®å®šçš„æ•°",
                difference: "æ— ç©·å°æ˜¯ä¸€ä¸ª<span class='highlight'>è¿‡ç¨‹</span>ï¼Œæ˜¯è¶‹å‘äº0çš„å˜é‡ï¼ˆå¦‚1/nå½“nâ†’âˆï¼‰ï¼›è€Œé›¶æ˜¯ä¸€ä¸ª<span class='highlight'>ç»“æœ</span>ï¼Œæ˜¯ç¡®å®šçš„æ•°å€¼0ã€‚æ— ç©·å°å¯ä»¥å‚ä¸è¿ç®—æ¯”è¾ƒé˜¶æ•°ï¼Œä½†0åªæ˜¯0ã€‚",
                analogy: "æ— ç©·å°åƒä¸€ä¸ªã€Œæ­£åœ¨ä¸‹å±±çš„äººã€â€”â€”è™½ç„¶è¶Šæ¥è¶Šæ¥è¿‘å±±è„šï¼Œä½†è¿˜åœ¨è·¯ä¸Šï¼›é›¶å°±æ˜¯ã€Œå·²ç»ç«™åœ¨å±±è„šã€çš„äººã€‚",
                tips: ["å¯ä»¥è¯´ã€Œæˆ‘æ˜¯å˜åŒ–çš„ã€ã€Œæˆ‘æœ‰é˜¶æ•°ä¹‹åˆ†ã€", "é¿å…è¯´ã€Œæˆ‘ç­‰äº0ã€"],
                exam: "å¸¸è€ƒï¼šæ— ç©·å°çš„é˜¶æ•°æ¯”è¾ƒã€ç­‰ä»·æ— ç©·å°æ›¿æ¢ã€æ— ç©·å°Ã—æœ‰ç•Œ=æ— ç©·å°"
            },

            {
                civ: "xâ†’xâ‚€", spy: "xâ†’xâ‚€âº",
                civ_def: "è‡ªå˜é‡xè¶‹äºæŸç‚¹xâ‚€ï¼ˆxâ†’xâ‚€ï¼‰",
                spy_def: "è‡ªå˜é‡xä»å³ä¾§è¶‹äºæŸç‚¹xâ‚€ï¼ˆxâ†’xâ‚€âºï¼‰",
                difference: "xâ†’xâ‚€è¡¨ç¤ºxä»ä»»æ„æ–¹å‘æ— é™æ¥è¿‘xâ‚€ï¼ˆ<span class='formula'>\(\lim\limits_{x\to x_0}f(x)\)</span>ï¼‰ï¼›xâ†’xâ‚€âºè¡¨ç¤ºxä»…ä»å³ä¾§ï¼ˆx>xâ‚€ï¼‰æ— é™æ¥è¿‘xâ‚€ï¼ˆ<span class='formula'>\(\lim\limits_{x\to x_0^+}f(x)\)</span>ï¼‰ã€‚å³æé™ä¸ä¸€å®šç­‰äºæ™®é€šæé™ã€‚",
                analogy: "xâ†’xâ‚€åƒä»å››é¢å…«æ–¹æ¥è¿‘æŸç‚¹ï¼›xâ†’xâ‚€âºåƒä»ä¸€æ¡è·¯ï¼ˆå³ä¾§ï¼‰é è¿‘åŒä¸€ä¸ªç‚¹ã€‚",
                tips: ["xâ†’xâ‚€ï¼šã€Œæˆ‘ä¸ç®¡ä»å·¦è¿˜æ˜¯å³ã€", "xâ†’xâ‚€âºï¼šã€Œæˆ‘åªèƒ½ä»å³è¾¹é è¿‘ã€"],
                exam: "å¸¸è€ƒï¼šè®¨è®ºåˆ†æ®µå‡½æ•°å·¦å³æé™ã€åˆ¤æ–­æé™æ˜¯å¦å­˜åœ¨"
            },
            {
                civ: "æé™å€¼", spy: "å‡½æ•°å€¼",
                civ_def: "å½“è‡ªå˜é‡è¶‹äºæŸç‚¹æ—¶ï¼Œå‡½æ•°çš„é€¼è¿‘å€¼",
                spy_def: "è‡ªå˜é‡å–æŸç‚¹æ—¶ï¼Œå‡½æ•°æœ¬èº«çš„å–å€¼",
                difference: "<span class='highlight'>æé™å€¼å­˜åœ¨æ—¶ï¼Œå‡½æ•°å€¼æœªå¿…ç›¸ç­‰ï¼›å‡½æ•°å€¼å­˜åœ¨ï¼Œæé™å€¼æœªå¿…å­˜åœ¨ï¼</span>æé™å€¼å…³å¿ƒã€è¶‹è¿‘ã€ï¼Œå‡½æ•°å€¼å…³å¿ƒã€å®é™…ã€ã€‚å¦‚f(x)=sin(1/x)åœ¨xâ†’0æé™ä¸å­˜åœ¨ï¼Œä½†å‡½æ•°å€¼æœªå®šä¹‰ã€‚",
                analogy: "æé™å€¼åƒã€Œé è¿‘é—¨å£çš„è„šæ­¥å£°ã€â€”â€”è¶Šæ¥è¶Šæ¥è¿‘å´ä¸ä¸€å®šè¿›é—¨ï¼›å‡½æ•°å€¼åƒã€Œé—¨å£çš„ä¸œè¥¿ã€â€”â€”é—¨å£å®é™…æœ‰ä»€ä¹ˆã€‚",
                tips: ["æé™å€¼ï¼šã€Œæˆ‘å…³å¿ƒçš„æ˜¯è¿‡ç¨‹ã€ã€Œåªçœ‹è¶Šæ¥è¶Šé è¿‘ã€", "å‡½æ•°å€¼ï¼šã€Œæˆ‘åªçœ‹è¿™ä¸€ç‚¹ã€"],
                exam: "å¸¸è€ƒï¼šåˆ¤æ–­æé™ä¸å‡½æ•°å€¼æ˜¯å¦ç›¸ç­‰ã€å¯å»é—´æ–­ç‚¹ã€æé™å­˜åœ¨ä½†å‡½æ•°å€¼æœªå®šä¹‰ç­‰"
            }
        ],
        derivatives: [
            {
                civ: "å¯¼æ•°", spy: "å¾®åˆ†",
                civ_def: "å˜åŒ–ç‡ï¼Œæ˜¯ä¸€ä¸ªæ•°å€¼",
                spy_def: "æ”¹å˜é‡çš„è¿‘ä¼¼ï¼Œdy = f'(x)dx",
                difference: "å¯¼æ•°<span class='formula'>f'(x)</span>æ˜¯<span class='highlight'>æ¯”å€¼çš„æé™</span>ï¼Œå›ç­”ã€Œå˜åŒ–æœ‰å¤šå¿«ã€ï¼›å¾®åˆ†<span class='formula'>dy = f'(x)dx</span>æ˜¯<span class='highlight'>çº¿æ€§ä¸»éƒ¨</span>ï¼Œå›ç­”ã€Œå˜åŒ–äº†å¤šå°‘ã€ã€‚å¯¼æ•°æ˜¯æ ‡é‡ï¼Œå¾®åˆ†æ˜¯å…³äºdxçš„è¡¨è¾¾å¼ã€‚",
                analogy: "å¯¼æ•°åƒã€Œè½¦é€Ÿè¡¨ä¸Šçš„æ•°å­—ã€â€”â€”å‘Šè¯‰ä½ æ¯å°æ—¶è·‘å¤šå°‘å…¬é‡Œï¼›å¾®åˆ†åƒã€Œè¿™ä¸€å°æ—¶å®é™…è·‘çš„è·¯ç¨‹ã€â€”â€”éœ€è¦ä¹˜ä»¥æ—¶é—´ã€‚",
                tips: ["å¯¼æ•°ï¼šã€Œæˆ‘æ˜¯å˜åŒ–ç‡ã€ã€Œæˆ‘æ˜¯æ¯”å€¼ã€", "å¾®åˆ†ï¼šã€Œæˆ‘æ˜¯å˜åŒ–é‡ã€ã€Œæˆ‘è¦ä¹˜dxã€"],
                exam: "å¸¸è€ƒï¼šåˆ©ç”¨å¾®åˆ†è¿‘ä¼¼è®¡ç®—ã€å…¨å¾®åˆ†ã€ä¸€é˜¶å¾®åˆ†å½¢å¼ä¸å˜æ€§"
            },
            {
                civ: "è¿ç»­", spy: "å¯å¯¼",
                civ_def: "å›¾åƒä¸æ–­å¼€",
                spy_def: "å›¾åƒå…‰æ»‘æ— å°–ç‚¹",
                difference: "<span class='highlight'>å¯å¯¼å¿…è¿ç»­ï¼Œè¿ç»­ä¸ä¸€å®šå¯å¯¼ï¼</span>è¿ç»­åªè¦æ±‚å‡½æ•°å›¾åƒã€Œä¸æ–­å¼€ã€ï¼ˆå·¦æé™=å³æé™=å‡½æ•°å€¼ï¼‰ï¼›å¯å¯¼è¿˜è¦æ±‚å›¾åƒã€Œå…‰æ»‘ã€ï¼ˆå·¦å¯¼æ•°=å³å¯¼æ•°ï¼‰ã€‚",
                analogy: "è¿ç»­åƒã€Œä¸€ç¬”ç”»ã€â€”â€”ç¬”ä¸ç¦»çº¸å°±è¡Œï¼›å¯å¯¼åƒã€Œä¸ç»¸èˆ¬é¡ºæ»‘ã€â€”â€”ä¸èƒ½æœ‰å°–è§’ã€æŠ˜ç—•ã€‚y=|x|åœ¨x=0å¤„è¿ç»­ä½†ä¸å¯å¯¼ã€‚",
                tips: ["å¯ä»¥è¯´ã€Œä¸æ–­å¼€ã€ã€Œæé™ç­‰äºå‡½æ•°å€¼ã€", "å¯å¯¼çš„äººå¯ä»¥è¯´ã€Œæˆ‘æ›´å…‰æ»‘ã€ã€Œæ²¡æœ‰å°–ç‚¹ã€"],
                exam: "å¸¸è€ƒï¼šåˆ¤æ–­åˆ†æ®µå‡½æ•°åœ¨åˆ†ç•Œç‚¹çš„è¿ç»­æ€§å’Œå¯å¯¼æ€§"
            },
            {
                civ: "åˆ‡çº¿", spy: "å‰²çº¿",
                civ_def: "æé™çŠ¶æ€ä¸‹çš„ç›´çº¿",
                spy_def: "ç©¿è¿‡æ›²çº¿ä¸Šä¸¤ç‚¹çš„ç›´çº¿",
                difference: "å‰²çº¿è¿æ¥æ›²çº¿ä¸Š<span class='highlight'>ä¸¤ä¸ªç‚¹</span>ï¼›å½“è¿™ä¸¤ç‚¹æ— é™æ¥è¿‘æ—¶ï¼Œå‰²çº¿çš„æé™ä½ç½®å°±æ˜¯<span class='highlight'>åˆ‡çº¿</span>ã€‚åˆ‡çº¿æ–œç‡å°±æ˜¯å¯¼æ•°çš„å‡ ä½•æ„ä¹‰ã€‚",
                analogy: "å‰²çº¿åƒã€Œä¸¤åŸä¹‹é—´çš„å…¬è·¯ã€â€”â€”è¿æ¥ä¸¤ä¸ªæ˜ç¡®çš„åœ°ç‚¹ï¼›åˆ‡çº¿åƒã€Œæ±½è½¦è¡Œé©¶çš„ç¬æ—¶æ–¹å‘ã€â€”â€”åªåœ¨ä¸€ç‚¹æœ‰æ„ä¹‰ã€‚",
                tips: ["å‰²çº¿ï¼šã€Œæˆ‘ç©¿è¿‡ä¸¤ç‚¹ã€ã€Œæˆ‘æœ‰ä¸¤ä¸ªäº¤ç‚¹ã€", "åˆ‡çº¿ï¼šã€Œæˆ‘åªç¢°ä¸€ç‚¹ã€ã€Œæˆ‘æ˜¯æé™ä½ç½®ã€"],
                exam: "å¸¸è€ƒï¼šå¯¼æ•°çš„å‡ ä½•æ„ä¹‰ã€åˆ‡çº¿æ–¹ç¨‹ã€æ³•çº¿æ–¹ç¨‹"
            },
            {
                civ: "é©»ç‚¹", spy: "æå€¼ç‚¹",
                civ_def: "ä¸€é˜¶å¯¼æ•°ä¸º0çš„ç‚¹",
                spy_def: "å‡½æ•°å–å¾—å±€éƒ¨æœ€å€¼çš„ç‚¹",
                difference: "<span class='highlight'>æå€¼ç‚¹ä¸€å®šæ˜¯é©»ç‚¹æˆ–ä¸å¯å¯¼ç‚¹ï¼Œä½†é©»ç‚¹ä¸ä¸€å®šæ˜¯æå€¼ç‚¹ï¼</span>å¦‚y=xÂ³åœ¨x=0æ˜¯é©»ç‚¹ä½†ä¸æ˜¯æå€¼ç‚¹ã€‚",
                analogy: "é©»ç‚¹åƒã€Œå±±è·¯ä¸Šçš„å¹³å°ã€â€”â€”æš‚æ—¶èµ°å¹³äº†ï¼Œä½†å¯èƒ½ç»§ç»­ä¸Šå±±ä¹Ÿå¯èƒ½ä¸‹å±±ï¼›æå€¼ç‚¹åƒã€Œå±±é¡¶æˆ–å±±è°·ã€â€”â€”çœŸæ­£çš„è½¬æŠ˜ç‚¹ã€‚",
                tips: ["é©»ç‚¹ï¼šã€Œæˆ‘çš„å¯¼æ•°æ˜¯0ã€ã€Œæˆ‘æ˜¯æ°´å¹³çš„ã€", "æå€¼ç‚¹ï¼šã€Œæˆ‘æ˜¯å±€éƒ¨æœ€é«˜/æœ€ä½ã€"],
                exam: "å¸¸è€ƒï¼šåˆ¤æ–­é©»ç‚¹æ˜¯å¦ä¸ºæå€¼ç‚¹ã€æå€¼çš„å……åˆ†æ¡ä»¶"
            },
            {
                civ: "æ‹ç‚¹", spy: "æå€¼ç‚¹",
                civ_def: "å‡¹å‡¸æ€§æ”¹å˜çš„ç‚¹",
                spy_def: "å•è°ƒæ€§æ”¹å˜çš„ç‚¹",
                difference: "æ‹ç‚¹çœ‹<span class='highlight'>äºŒé˜¶å¯¼</span>å˜å·ï¼ˆå‡¹å‡¸æ€§æ”¹å˜ï¼‰ï¼›æå€¼ç‚¹çœ‹<span class='highlight'>ä¸€é˜¶å¯¼</span>å˜å·ï¼ˆå•è°ƒæ€§æ”¹å˜ï¼‰ã€‚æ‹ç‚¹åœ¨æ›²çº¿ä¸Šï¼Œæå€¼ç‚¹æ˜¯å‡½æ•°å€¼ã€‚",
                analogy: "æ‹ç‚¹åƒã€Œæ–¹å‘ç›˜ä»å·¦æ‰“åˆ°å³ã€â€”â€”å¼¯æ›²æ–¹å‘å˜äº†ï¼›æå€¼ç‚¹åƒã€Œä»ä¸Šå¡å˜ä¸‹å¡ã€â€”â€”é«˜ä½è¶‹åŠ¿å˜äº†ã€‚",
                tips: ["æ‹ç‚¹ï¼šã€Œæˆ‘è®©æ›²çº¿ä»å‡¹å˜å‡¸ã€ã€ŒäºŒé˜¶å¯¼å˜å·ã€", "æå€¼ç‚¹ï¼šã€Œæˆ‘è®©å‡½æ•°ä»å¢å˜å‡ã€"],
                exam: "å¸¸è€ƒï¼šåˆ¤æ–­æ‹ç‚¹ã€åˆ©ç”¨äºŒé˜¶å¯¼åˆ¤æ–­å‡¹å‡¸æ€§"
            },
            {
                civ: "å¢é‡", spy: "å¾®åˆ†",
                civ_def: "å‡½æ•°è‡ªå˜é‡å˜åŒ–å¼•èµ·çš„å¯¹åº”å‡½æ•°å€¼å˜åŒ–ï¼ŒÎ”y = f(x+Î”x) - f(x)",
                spy_def: "å‡½æ•°å¢é‡çš„çº¿æ€§ä¸»éƒ¨ï¼Œdy = f'(x)dx",
                difference: "å¢é‡Î”yæ˜¯è‡ªå˜é‡å˜åŒ–åå‡½æ•°å€¼çš„å®é™…æ”¹å˜ï¼›å¾®åˆ†dyæ˜¯å¢é‡Î”yçš„ä¸»è¦çº¿æ€§éƒ¨åˆ†ï¼ˆè¿‘ä¼¼ï¼‰ï¼Œå¿½ç•¥äº†é«˜é˜¶æ— ç©·å°ã€‚<span class='highlight'>å¾®åˆ†æ˜¯å¢é‡çš„è¿‘ä¼¼</span>ï¼Œåªæœ‰åœ¨Î”xè¶‹è¿‘äº0æ—¶æ‰è¿‘ä¼¼ç­‰äºå¢é‡ã€‚",
                analogy: "å¢é‡åƒã€Œå®é™…èµ°çš„è·¯ã€â€”â€”å‡†ç¡®è®¡ç®—å‡ºå»äº†å¤šå°‘ï¼›å¾®åˆ†åƒã€Œåœ°å›¾ä¸Šç”»å‡ºçš„ç›´çº¿è·ç¦»ã€â€”â€”å‡è®¾è·¯ä¸€ç›´ç¬”ç›´ã€‚",
                tips: ["å¢é‡ï¼šã€Œæˆ‘æ˜¯çœŸå®å˜åŒ–ã€ã€ŒåŒ…æ‹¬å…¨éƒ¨å½±å“ã€", "å¾®åˆ†ï¼šã€Œæˆ‘æ˜¯è¿‘ä¼¼å˜åŒ–ã€ã€Œåªä¿ç•™çº¿æ€§éƒ¨åˆ†ã€"],
                exam: "å¸¸è€ƒï¼šå¢é‡ä¸å¾®åˆ†çš„åŒºåˆ«ã€ç”¨å¾®åˆ†è¿‘ä¼¼è®¡ç®—å®é™…å˜åŒ–"
            }
        ],
        applications: [

            {
                civ: "å‡¹å‡½æ•°", spy: "å‡¸å‡½æ•°",
                civ_def: "å¼¦åœ¨å¼§ä¸Šæ–¹ï¼ˆæ•™æå®šä¹‰ï¼Œf''(x)>0ï¼‰",
                spy_def: "å¼¦åœ¨å¼§ä¸‹æ–¹",
                difference: "æ³¨æ„ï¼š<span class='highlight'>å›½å†…å¤–å®šä¹‰ç›¸åï¼</span>å›½å†…æ•™æï¼šf''(x)>0æ˜¯å‡¹å‡½æ•°ï¼ˆå¼€å£æœä¸Šï¼‰ï¼›å›½å¤–ï¼šf''(x)>0æ˜¯convexï¼ˆå‡¸å‡½æ•°ï¼‰ã€‚è€ƒè¯•ä»¥æ•™æä¸ºå‡†ã€‚",
                analogy: "å‡¹å‡½æ•°åƒã€Œç¢—ã€â€”â€”å¯ä»¥ç››æ°´ï¼›å‡¸å‡½æ•°åƒã€Œå€’æ‰£çš„ç¢—ã€â€”â€”æ°´ä¼šæµèµ°ã€‚è®°ä½ï¼šèƒ½ç››æ°´çš„æ˜¯å‡¹ï¼",
                tips: ["å‡¹ï¼šã€Œæˆ‘èƒ½ç››æ°´ã€ã€ŒäºŒé˜¶å¯¼>0ã€ã€Œå¼€å£æœä¸Šã€", "å‡¸ï¼šã€Œæˆ‘åƒå±±ä¸˜ã€ã€ŒäºŒé˜¶å¯¼<0ã€"],
                exam: "å¸¸è€ƒï¼šåˆ¤æ–­å‡¹å‡¸æ€§ã€åˆ©ç”¨å‡¹å‡¸æ€§è¯æ˜ä¸ç­‰å¼"
            },
            {
                civ: "æœ€å¤§å€¼", spy: "æå¤§å€¼",
                civ_def: "å…¨å±€æœ€é«˜",
                spy_def: "å±€éƒ¨æœ€é«˜",
                difference: "æœ€å¤§å€¼æ˜¯<span class='highlight'>å…¨å±€å† å†›</span>ï¼Œåœ¨æ•´ä¸ªåŒºé—´ä¸Šæœ€å¤§ï¼›æå¤§å€¼æ˜¯<span class='highlight'>å±€éƒ¨å† å†›</span>ï¼Œåªåœ¨é‚»åŸŸå†…æœ€å¤§ã€‚ä¸€ä¸ªå‡½æ•°å¯ä»¥æœ‰å¤šä¸ªæå¤§å€¼ï¼Œä½†åªæœ‰ä¸€ä¸ªæœ€å¤§å€¼ã€‚",
                analogy: "æå¤§å€¼åƒã€Œæ‘é‡Œçš„é¦–å¯Œã€â€”â€”åªæ˜¯å½“åœ°æœ€æœ‰é’±ï¼›æœ€å¤§å€¼åƒã€Œå…¨å›½é¦–å¯Œã€â€”â€”æ•´ä½“æœ€æœ‰é’±ã€‚",
                tips: ["æå¤§å€¼ï¼šã€Œæˆ‘åªæ˜¯é™„è¿‘æœ€é«˜ã€ã€Œå¯èƒ½æœ‰å¥½å‡ ä¸ªã€", "æœ€å¤§å€¼ï¼šã€Œæˆ‘æ˜¯æ•´ä½“æœ€é«˜ã€ã€Œåªæœ‰ä¸€ä¸ªã€"],
                exam: "å¸¸è€ƒï¼šé—­åŒºé—´ä¸Šæ±‚æœ€å€¼ï¼ˆæ¯”è¾ƒç«¯ç‚¹å’Œé©»ç‚¹ï¼‰"
            },
            {
                civ: "æ¸è¿‘çº¿", spy: "åˆ‡çº¿",
                civ_def: "æ›²çº¿æ— é™æ¥è¿‘ä½†ä¸ç›¸äº¤çš„ç›´çº¿",
                spy_def: "ä¸æ›²çº¿ç›¸åˆ‡çš„ç›´çº¿",
                difference: "æ¸è¿‘çº¿æ˜¯<span class='highlight'>è¶‹åŠ¿æ€§çš„</span>ï¼ˆxæˆ–yâ†’âˆæ—¶æ›²çº¿é è¿‘çš„ç›´çº¿ï¼‰ï¼›åˆ‡çº¿æ˜¯<span class='highlight'>å±€éƒ¨çš„</span>ï¼ˆåœ¨æŸç‚¹ä¸æ›²çº¿ç›¸åˆ‡ï¼‰ã€‚",
                analogy: "æ¸è¿‘çº¿åƒã€Œè¿œæ–¹çš„åœ°å¹³çº¿ã€â€”â€”è¶Šèµ°è¶Šè¿‘ä½†æ°¸è¿œåˆ°ä¸äº†ï¼›åˆ‡çº¿åƒã€Œæ­¤åˆ»è„šè¸©çš„è·¯ã€â€”â€”å°±åœ¨å½“ä¸‹è¿™ä¸€ç‚¹ã€‚",
                tips: ["æ¸è¿‘çº¿ï¼šã€Œæˆ‘åœ¨æ— ç©·è¿œã€ã€Œæ›²çº¿å‘æˆ‘é è¿‘ã€", "åˆ‡çº¿ï¼šã€Œæˆ‘åœ¨æŸä¸€ç‚¹ã€ã€Œæ›²çº¿ä»æˆ‘ç»è¿‡ã€"],
                exam: "å¸¸è€ƒï¼šæ±‚æ°´å¹³/å‚ç›´/æ–œæ¸è¿‘çº¿"
            }
        ],
        integrals: [
            {
                civ: "ä¸å®šç§¯åˆ†", spy: "å®šç§¯åˆ†",
                civ_def: "åŸå‡½æ•°çš„å…¨ä½“ï¼Œå«+C",
                spy_def: "æ›²è¾¹æ¢¯å½¢çš„é¢ç§¯ï¼Œæ˜¯ä¸€ä¸ªæ•°",
                difference: "ä¸å®šç§¯åˆ†æ˜¯<span class='highlight'>æ±‚åŸå‡½æ•°</span>ï¼Œç»“æœæ˜¯å‡½æ•°æ—ï¼ˆ+Cï¼‰ï¼›å®šç§¯åˆ†æ˜¯<span class='highlight'>ç®—é¢ç§¯</span>ï¼Œç»“æœæ˜¯ä¸€ä¸ªæ•°å€¼ã€‚è™½ç„¶è®¡ç®—æŠ€å·§ç›¸ä¼¼ï¼Œä½†æœ¬è´¨ä¸åŒï¼",
                analogy: "ä¸å®šç§¯åˆ†åƒã€Œæ‰¾åˆ°æ‰€æœ‰å¯èƒ½çš„çˆ¶æ¯ã€â€”â€”æ˜¯ä¸€ä¸ªå®¶æ—ï¼ˆ+Cï¼‰ï¼›å®šç§¯åˆ†åƒã€Œç®—å‡ºä¸€å—ç”°çš„é¢ç§¯ã€â€”â€”æ˜¯ä¸ªç¡®å®šçš„æ•°å­—ã€‚",
                tips: ["ä¸å®šç§¯åˆ†ï¼šã€Œæˆ‘æ˜¯å‡½æ•°ã€ã€Œæˆ‘æœ‰+Cã€", "å®šç§¯åˆ†ï¼šã€Œæˆ‘æ˜¯æ•°å€¼ã€ã€Œæˆ‘æœ‰ä¸Šä¸‹é™ã€"],
                exam: "å¸¸è€ƒï¼šæ±‚ä¸å®šç§¯åˆ†ã€ç”¨å®šç§¯åˆ†æ±‚é¢ç§¯/ä½“ç§¯"
            },
            {
                civ: "åŸå‡½æ•°", spy: "ç§¯åˆ†ä¸Šé™å‡½æ•°",
                civ_def: "å¯¼æ•°ç­‰äºåŸæ¥å‡½æ•°çš„å‡½æ•°",
                spy_def: "ä¸Šé™æ˜¯å˜é‡çš„å®šç§¯åˆ†",
                difference: "åŸå‡½æ•°F(x)æ»¡è¶³<span class='formula'>F'(x)=f(x)</span>ï¼›ç§¯åˆ†ä¸Šé™å‡½æ•°æ˜¯<span class='formula'>âˆ«â‚€Ë£f(t)dt</span>ï¼Œæ˜¯åŸå‡½æ•°çš„ä¸€ä¸ªç‰¹ä¾‹ï¼ˆä¸‹é™ä¸ºå¸¸æ•°æ—¶ï¼‰ã€‚",
                analogy: "åŸå‡½æ•°åƒã€Œæ‰€æœ‰é€šå¾€ç»ˆç‚¹çš„è·¯ã€â€”â€”æœ‰æ— ç©·å¤šæ¡ï¼ˆç›¸å·®å¸¸æ•°ï¼‰ï¼›ç§¯åˆ†ä¸Šé™å‡½æ•°åƒã€Œä»èµ·ç‚¹å‡ºå‘çš„é‚£æ¡è·¯ã€â€”â€”èµ·ç‚¹å›ºå®šåè·¯å”¯ä¸€ã€‚",
                tips: ["åŸå‡½æ•°ï¼šã€Œæˆ‘æ˜¯ä¸€æ—å‡½æ•°ã€ã€Œç›¸å·®å¸¸æ•°ã€", "ç§¯åˆ†ä¸Šé™å‡½æ•°ï¼šã€Œæˆ‘çš„ä¸‹é™æ˜¯å¸¸æ•°ã€ã€Œå¯¼æ•°æ˜¯è¢«ç§¯å‡½æ•°ã€"],
                exam: "å¸¸è€ƒï¼šå˜é™ç§¯åˆ†æ±‚å¯¼ã€åŸå‡½æ•°å­˜åœ¨æ€§å®šç†"
            },
            {
                civ: "æ¢å…ƒç§¯åˆ†", spy: "åˆ†éƒ¨ç§¯åˆ†",
                civ_def: "ç”¨æ›¿æ¢å˜é‡ç®€åŒ–ç§¯åˆ†",
                spy_def: "æŠŠç§¯åˆ†æ‹†æˆä¸¤éƒ¨åˆ†",
                difference: "æ¢å…ƒæ˜¯<span class='highlight'>æ¢ä¸ªè§’åº¦çœ‹</span>ï¼ˆä»¤u=g(x)ï¼‰ï¼›åˆ†éƒ¨æ˜¯<span class='highlight'>æ‹†è§£è½¬ç§»</span>ï¼ˆæŠŠå¯¼æ•°ä»ä¸€ä¸ªå‡½æ•°è½¬åˆ°å¦ä¸€ä¸ªï¼šâˆ«udv=uv-âˆ«vduï¼‰ã€‚",
                analogy: "æ¢å…ƒåƒã€Œæ¢ä¸€å‰¯çœ¼é•œçœ‹é—®é¢˜ã€â€”â€”æœ¬è´¨æ²¡å˜ï¼Œè§†è§’å˜äº†ï¼›åˆ†éƒ¨åƒã€Œæ¥åŠ›èµ›äº¤æ¥æ£’ã€â€”â€”æŠŠç§¯åˆ†çš„è´Ÿæ‹…ä»ä¸€è¾¹è½¬åˆ°å¦ä¸€è¾¹ã€‚",
                tips: ["æ¢å…ƒï¼šã€Œæˆ‘æ˜¯å˜é‡æ›¿æ¢ã€ã€Œå‡‘å¾®åˆ†ã€", "åˆ†éƒ¨ï¼šã€Œæˆ‘æ˜¯ä¹˜ç§¯çš„ç§¯åˆ†ã€ã€Œâˆ«udvã€"],
                exam: "å¸¸è€ƒï¼šæ ¹å·ç”¨æ¢å…ƒã€æŒ‡æ•°Ã—ä¸‰è§’ç”¨åˆ†éƒ¨"
            },
            {
                civ: "åå¸¸ç§¯åˆ†", spy: "å®šç§¯åˆ†",
                civ_def: "ç§¯åˆ†åŒºé—´æ— ç©·æˆ–è¢«ç§¯å‡½æ•°æ— ç•Œ",
                spy_def: "æœ‰é™åŒºé—´ä¸Šæœ‰ç•Œå‡½æ•°çš„ç§¯åˆ†",
                difference: "å®šç§¯åˆ†åœ¨<span class='highlight'>æœ‰é™åŒºé—´</span>ä¸Šï¼Œè¢«ç§¯å‡½æ•°æœ‰ç•Œï¼›åå¸¸ç§¯åˆ†æœ‰<span class='highlight'>ã€Œæ— ç©·ã€</span>â€”â€”è¦ä¹ˆåŒºé—´æ— ç©·ï¼Œè¦ä¹ˆå‡½æ•°æœ‰ç‘•ç‚¹ã€‚åå¸¸ç§¯åˆ†è¦åˆ¤æ–­æ”¶æ•›æ€§ï¼",
                analogy: "å®šç§¯åˆ†åƒã€Œç®—ä¸€å—ç”°çš„é¢ç§¯ã€â€”â€”è¾¹ç•Œæ¸…æ¥šï¼›åå¸¸ç§¯åˆ†åƒã€Œç®—æ— è¾¹çš„è‰åŸã€â€”â€”å¯èƒ½æ— ç©·å¤§ï¼Œä¹Ÿå¯èƒ½æ”¶æ•›åˆ°æœ‰é™å€¼ã€‚",
                tips: ["å®šç§¯åˆ†ï¼šã€Œæˆ‘åŒºé—´æœ‰é™ã€ã€Œå‡½æ•°æœ‰ç•Œã€", "åå¸¸ç§¯åˆ†ï¼šã€Œæˆ‘æœ‰æ— ç©·ã€ã€Œè¦åˆ¤æ–­æ”¶æ•›ã€"],
                exam: "å¸¸è€ƒï¼šåˆ¤æ–­åå¸¸ç§¯åˆ†æ”¶æ•›æ€§ã€è®¡ç®—åå¸¸ç§¯åˆ†"
            }
        ],
        mixed: [], // å°†åœ¨åˆå§‹åŒ–æ—¶å¡«å……
        classic: [
            {
                civ: "è‹¹æœ", spy: "æ¢¨",
                civ_def: "çº¢è‰²åœ†å½¢æ°´æœ",
                spy_def: "é»„ç»¿è‰²çš„æ°´æœ",
                difference: "è‹¹æœé€šå¸¸æ˜¯åœ†å½¢ï¼Œæœçš®é¢œè‰²å¤šä¸ºçº¢è‰²æˆ–é’è‰²ï¼›æ¢¨æ˜¯è‘«èŠ¦å½¢ï¼Œé€šå¸¸é»„ç»¿è‰²ï¼Œå£æ„Ÿæ›´è„†ã€‚",
                analogy: "è‹¹æœåƒã€Œå°çƒã€â€”â€”åœ†æ»šæ»šçš„ï¼›æ¢¨åƒã€Œå°è‘«èŠ¦ã€â€”â€”ä¸Šå°ä¸‹å¤§ã€‚",
                tips: ["è‹¹æœï¼šã€Œæˆ‘æ˜¯åœ†çš„ã€ã€Œæˆ‘å¸¸è§çº¢è‰²ã€", "æ¢¨ï¼šã€Œæˆ‘æ˜¯è‘«èŠ¦å½¢ã€ã€Œæˆ‘å¾ˆè„†ã€"],
                exam: "è¿™æ˜¯ç»å…¸æ¬¾ï¼Œæ”¾æ¾ä¸€ä¸‹ï¼"
            },
            {
                civ: "å’–å•¡", spy: "èŒ¶",
                civ_def: "æ¥è‡ªå’–å•¡è±†çš„é¥®å“",
                spy_def: "æ¥è‡ªèŒ¶å¶çš„é¥®å“",
                difference: "å’–å•¡æ¥è‡ªçƒ˜ç„™çš„å’–å•¡è±†ï¼Œå‘³é“è‹¦æµ“ï¼›èŒ¶æ¥è‡ªèŒ¶å¶ï¼Œæ›´æ¸…æ·¡é›…è‡´ã€‚",
                analogy: "å’–å•¡åƒã€Œæµ“çƒˆçš„æ‘‡æ»šä¹ã€â€”â€”åˆºæ¿€æç¥ï¼›èŒ¶åƒã€Œæ‚ æ‰¬çš„å¤å…¸ä¹ã€â€”â€”æ¸…å¹½å®é™ã€‚",
                tips: ["å’–å•¡ï¼šã€Œæˆ‘æ˜¯è±†å­åšçš„ã€ã€Œæˆ‘å¾ˆè‹¦ã€", "èŒ¶ï¼šã€Œæˆ‘æ˜¯å¶å­åšçš„ã€ã€Œæˆ‘æ¸…é¦™ã€"],
                exam: "è¿™æ˜¯ç»å…¸æ¬¾ï¼Œæ”¾æ¾ä¸€ä¸‹ï¼"
            },
            {
                civ: "æ‰‹æœº", spy: "ç”µè¯",
                civ_def: "å¯éšèº«æºå¸¦çš„é€šè®¯è®¾å¤‡",
                spy_def: "å›ºå®šä½ç½®çš„é€šè®¯è®¾å¤‡",
                difference: "æ‰‹æœºå¯ä»¥å¸¦ç€èµ°ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼›ç”µè¯ï¼ˆåº§æœºï¼‰å›ºå®šåœ¨æŸå¤„ï¼ŒåŠŸèƒ½å•ä¸€ã€‚",
                analogy: "æ‰‹æœºåƒã€Œéšèº«åŠ©æ‰‹ã€â€”â€”è·Ÿç€ä½ åˆ°å¤„èµ°ï¼›ç”µè¯åƒã€Œå®¶é‡Œçš„é—¨å«ã€â€”â€”åªåœ¨ä¸€ä¸ªåœ°æ–¹å®ˆç€ã€‚",
                tips: ["æ‰‹æœºï¼šã€Œæˆ‘èƒ½å¸¦èµ°ã€ã€Œæˆ‘åŠŸèƒ½å¤šã€", "ç”µè¯ï¼šã€Œæˆ‘åœ¨å®¶é‡Œã€ã€Œæˆ‘æœ‰çº¿ã€"],
                exam: "è¿™æ˜¯ç»å…¸æ¬¾ï¼Œæ”¾æ¾ä¸€ä¸‹ï¼"
            },
            {
                civ: "ç”µå½±", spy: "ç”µè§†å‰§",
                civ_def: "æ—¶é•¿è¾ƒçŸ­çš„å½±è§†ä½œå“",
                spy_def: "å¤šé›†è¿ç»­çš„å½±è§†ä½œå“",
                difference: "ç”µå½±é€šå¸¸2å°æ—¶å·¦å³ï¼Œå®Œæ•´è®²è¿°ä¸€ä¸ªæ•…äº‹ï¼›ç”µè§†å‰§å¤šé›†è¿æ’­ï¼Œæ•…äº‹å¯ä»¥æ›´é•¿æ›´ç»†è‡´ã€‚",
                analogy: "ç”µå½±åƒã€ŒçŸ­ç¯‡å°è¯´ã€â€”â€”ç²¾ç‚¼æµ“ç¼©ï¼›ç”µè§†å‰§åƒã€Œé•¿ç¯‡å°è¯´ã€â€”â€”ç»†æ°´é•¿æµã€‚",
                tips: ["ç”µå½±ï¼šã€Œæˆ‘ä¸€æ¬¡çœ‹å®Œã€ã€Œæˆ‘åœ¨ç”µå½±é™¢ã€", "ç”µè§†å‰§ï¼šã€Œæˆ‘åˆ†å¾ˆå¤šé›†ã€ã€Œæˆ‘åœ¨å®¶çœ‹ã€"],
                exam: "è¿™æ˜¯ç»å…¸æ¬¾ï¼Œæ”¾æ¾ä¸€ä¸‹ï¼"
            }
        ]
    };

    // åˆå§‹åŒ–æ··åˆè¯åº“
    wordPacks.mixed = [
        ...wordPacks.limits,
        ...wordPacks.derivatives,
        ...wordPacks.applications,
        ...wordPacks.integrals
    ];

    // ============================================
    // 2. GAME STATE
    // ============================================
    const state = {
        totalPlayers: 6,
        spyCount: 1,
        packName: 'limits',
        currentWords: null,
        players: [],
        currentIdx: 0,
        godViewOpen: false
    };

    // ============================================
    // 3. VIEW MANAGEMENT
    // ============================================
    function showView(viewId) {
        ['view-setup', 'view-pass', 'view-reveal', 'view-game', 'view-end']
            .forEach(id => document.getElementById(id).classList.add('hidden'));
        document.getElementById(viewId).classList.remove('hidden');
    }

    // ============================================
    // 4. SETUP FUNCTIONS
    // ============================================
    // Player slider
    const slider = document.getElementById('player-slider');
    slider.addEventListener('input', (e) => {
        state.totalPlayers = parseInt(e.target.value);
        document.getElementById('player-count-display').textContent = state.totalPlayers;
        // Auto-adjust spy count if needed
        if (state.totalPlayers < 6 && state.spyCount > 1) setSpyCount(1);
    });

    // Spy count buttons
    function setSpyCount(n) {
        state.spyCount = n;
        document.getElementById('spy-count-display').textContent = n;
        document.querySelectorAll('.btn-group .btn').forEach(btn => {
            btn.classList.toggle('active', parseInt(btn.dataset.spy) === n);
        });
    }

    // Pack selection
    function selectPack(pack) {
        state.packName = pack;
        document.querySelectorAll('.pack-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.pack === pack);
        });
    }

    // ============================================
    // 5. GAME FLOW
    // ============================================
    function startGame() {
        // Select random word pair
        const pool = wordPacks[state.packName];
        state.currentWords = pool[Math.floor(Math.random() * pool.length)];

        // Assign roles
        let roles = Array(state.spyCount).fill('spy');
        while (roles.length < state.totalPlayers) roles.push('civ');
        roles.sort(() => Math.random() - 0.5);

        // Create player data
        state.players = roles.map((role, i) => ({
            id: i + 1,
            role: role,
            word: role === 'civ' ? state.currentWords.civ : state.currentWords.spy,
            status: 'alive'
        }));

        state.currentIdx = 0;
        updatePassView();
        showView('view-pass');
    }

    function updatePassView() {
        const num = state.players[state.currentIdx].id;
        document.getElementById('pass-player-num').textContent = num + 'å·';
        document.getElementById('btn-pass-num').textContent = num + 'å·';
    }

    function enterReveal() {
        const player = state.players[state.currentIdx];
        document.getElementById('reveal-player-id').textContent = `PLAYER ${player.id}`;
        document.getElementById('word-display').textContent = player.word;
        
        // Reset card
        document.getElementById('card-element').classList.remove('flipped');
        document.getElementById('btn-next-player').classList.add('hidden');
        
        showView('view-reveal');
    }

    function flipCard() {
        const card = document.getElementById('card-element');
        if (!card.classList.contains('flipped')) {
            card.classList.add('flipped');
            setTimeout(() => {
                document.getElementById('btn-next-player').classList.remove('hidden');
            }, 400);
        }
    }

    function nextPlayer() {
        state.currentIdx++;
        if (state.currentIdx < state.totalPlayers) {
            updatePassView();
            showView('view-pass');
        } else {
            initGameView();
            showView('view-game');
        }
    }

    // ============================================
    // 6. GAME VIEW (å«ä¸Šå¸è§†è§’)
    // ============================================
    function initGameView() {
        renderPlayers();
        updateGodView();
        state.godViewOpen = false;
        document.getElementById('god-view-body').classList.remove('open');
        document.getElementById('god-view-icon').style.transform = '';
    }

    function renderPlayers(showRoles = false) {
        const list = document.getElementById('player-list');
        list.innerHTML = '';
        
        let alive = 0;
        state.players.forEach(p => {
            if (p.status === 'alive') alive++;
            
            const item = document.createElement('div');
            item.className = `player-item ${p.status === 'dead' ? 'dead' : ''}`;
            
            let roleHtml = '';
            if (showRoles) {
                const roleClass = p.role === 'spy' ? 'spy' : 'civ';
                const roleText = p.role === 'spy' ? 'å§åº•' : 'å¹³æ°‘';
                roleHtml = `<span class="player-role ${roleClass}">${roleText}: ${p.word}</span>`;
            }
            
            item.innerHTML = `
                <div class="player-info">
                    <div class="player-avatar">${p.id}</div>
                    <div>
                        <div>ç©å®¶ ${p.id} ${p.status === 'dead' ? '<span style="color:var(--accent-red);font-size:0.8rem;">(å·²å‡ºå±€)</span>' : ''}</div>
                        ${roleHtml}
                    </div>
                </div>
                ${p.status === 'alive' && !showRoles ? `
                    <button class="btn btn-small btn-danger" onclick="killPlayer(${p.id})">æ·˜æ±°</button>
                ` : ''}
            `;
            list.appendChild(item);
        });
        
        document.getElementById('alive-count').textContent = `${alive}/${state.totalPlayers}`;
    }

    function updateGodView() {
        const w = state.currentWords;
        document.getElementById('god-word-civ').textContent = w.civ;
        document.getElementById('god-def-civ').textContent = w.civ_def;
        document.getElementById('god-word-spy').textContent = w.spy;
        document.getElementById('god-def-spy').textContent = w.spy_def;
        document.getElementById('god-difference').innerHTML = w.difference;
        document.getElementById('god-analogy').innerHTML = w.analogy;
        document.getElementById('god-exam').innerHTML = w.exam;
        
        const tipsList = document.getElementById('god-tips');
        tipsList.innerHTML = w.tips.map(t => `<li>${t}</li>`).join('');
    }

    function toggleGodView() {
        state.godViewOpen = !state.godViewOpen;
        document.getElementById('god-view-body').classList.toggle('open', state.godViewOpen);
        document.getElementById('god-view-icon').style.transform = state.godViewOpen ? 'rotate(180deg)' : '';
    }

    function killPlayer(id) {
        if (!confirm(`ç¡®è®¤æ·˜æ±° ${id} å·ç©å®¶ï¼Ÿ`)) return;
        state.players.find(p => p.id === id).status = 'dead';
        renderPlayers();
        checkWinner();
    }

    function checkWinner() {
        const liveSpies = state.players.filter(p => p.role === 'spy' && p.status === 'alive').length;
        const liveCivs = state.players.filter(p => p.role === 'civ' && p.status === 'alive').length;
        
        if (liveSpies === 0) {
            endGame('ğŸ‰ å¹³æ°‘èƒœåˆ©ï¼');
        } else if (liveSpies >= liveCivs) {
            endGame('ğŸ•µï¸ å§åº•èƒœåˆ©ï¼');
        }
    }

    // ============================================
    // 7. END GAME
    // ============================================
    function endGame(msg) {
        if (!msg && !confirm('ç¡®å®šç›´æ¥ç»“æŸæ¸¸æˆï¼Ÿ')) return;
        msg = msg || 'æ¸¸æˆç»“æŸ';
        
        document.getElementById('winner-text').textContent = msg;
        
        const w = state.currentWords;
        document.getElementById('end-word-civ').textContent = w.civ;
        document.getElementById('end-def-civ').textContent = w.civ_def;
        document.getElementById('end-word-spy').textContent = w.spy;
        document.getElementById('end-def-spy').textContent = w.spy_def;
        
        const endList = document.getElementById('end-player-list');
        endList.innerHTML = '';
        state.players.forEach(p => {
            const li = document.createElement('li');
            const color = p.role === 'spy' ? 'var(--accent-red)' : 'var(--accent-green)';
            const roleText = p.role === 'spy' ? 'å§åº•' : 'å¹³æ°‘';
            li.innerHTML = `ç©å®¶ ${p.id}: <strong style="color:${color}">${roleText}</strong> <span style="color:var(--text-muted);">(${p.word})</span>`;
            endList.appendChild(li);
        });
        
        showView('view-end');
    }

    function resetGame() {
        showView('view-setup');
    }

    // ============================================
    // 8. UTILITIES
    // ============================================
    function toggleRules() {
        const content = document.getElementById('rules-content');
        const header = content.previousElementSibling;
        content.classList.toggle('open');
        header.classList.toggle('open');
    }
    </script>
</body>
</html>